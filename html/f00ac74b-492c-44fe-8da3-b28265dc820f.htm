<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Project Setup (C#)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="f00ac74b-492c-44fe-8da3-b28265dc820f" /><meta name="Description" content="Grasshopper Component Library Project Setup in C#" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Grasshopper API<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/723c01da-9986-4db2-8f53-6f3a7494df75.htm" title="Grasshopper API" tocid="roottoc">Grasshopper API</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/8b9acc0a-5165-4427-aea5-1873faffb4ff.htm" title="Development" tocid="8b9acc0a-5165-4427-aea5-1873faffb4ff">Development</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/d5ac95cc-3592-49a7-9162-d1bd981fb6c5.htm" title="GHA Assembly Wizards" tocid="d5ac95cc-3592-49a7-9162-d1bd981fb6c5">GHA Assembly Wizards</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/bc188193-19ff-4ae5-a3ed-2e78c34a306e.htm" title="Assembly Hierarchy" tocid="bc188193-19ff-4ae5-a3ed-2e78c34a306e">Assembly Hierarchy</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/99f64b89-5975-4ebe-adc6-24da038e915f.htm" title="Project Setup (VB.NET)" tocid="99f64b89-5975-4ebe-adc6-24da038e915f">Project Setup (VB.NET)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/f00ac74b-492c-44fe-8da3-b28265dc820f.htm" title="Project Setup (C#)" tocid="f00ac74b-492c-44fe-8da3-b28265dc820f">Project Setup (C#)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/71bed5cf-25c6-4d89-b50a-cff22efbda62.htm" title="Project Setup (VS.Express)" tocid="71bed5cf-25c6-4d89-b50a-cff22efbda62">Project Setup (VS.Express)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Project Setup (C#)</h1></td></tr></table><span class="introStyle"></span> <div class="summary"><p>Grasshopper Component Library Project Setup in C#</p></div><div class="introduction"><p><strong>Please note that we now have
      <a href="d5ac95cc-3592-49a7-9162-d1bd981fb6c5.htm">Assembly Wizards for Grasshopper</a>
      and it is no longer necessary to manually
      create a GHA project in Visual Studio.</strong></p><p>
      This topic outlines all the steps required to create a new project in 
      <em>C#</em> which will create a Grasshopper Component Library. If you are using 
      <em>C# Express</em>, some of these steps will differ since the Express version 
      does not expose a UI for all these settings.
      </p></div><h3 class="procedureSubHeading">Creating a new Project</h3><div class="subSection"><ol><li><p>Start Visual Studio and create a new project via the File menu.</p><p><div class="mediaNear"><img src="../media/Separator_20Pixels_FullAlpha.png" /></div></p></li><li><p>In the <em>Project types</em> tree, navigate towards the 
            <em>Visual C#</em> root node. Make sure the Target Framework is 3.5 and select 
            the <em>Class Library</em> type:</p><p><div class="mediaCenter"><img src="../media/CS_Pro_NewProject.png" /></div></p><p><div class="mediaNear"><img src="../media/Separator_20Pixels_FullAlpha.png" /></div></p></li><li><p>A new, empty project will now be created. Before this project becomes a valid Grasshopper 
            Component Library, we have to add all the required Assembly References. In your Solution Explorer pane, 
            find the References node and make sure the list includes the assemblies listed below.</p><p>Careful! When adding Assembly Reference, the default Visual Studio behaviour is 
            to tag them as <em>CopyLocal=True</em>. This is wrong. So very wrong. Set the Copy Local tag 
            of GH_IO, Grasshopper and RhinoCommon to <em>False</em> before you press the Compile button 
            for the first time.</p><p><div class="mediaCenter"><img src="../media/CS_Pro_References.png" /></div><div class="mediaCenter"><img src="../media/CS_Pro_CopyLocalFalse.png" /></div></p><p>Note that the folder locations for RhinoCommon, Grasshopper and GH_IO will differ 
            depending on installation.</p><div class="tableSection"><table><tr><th>Assembly</th><th>Probable location</th></tr><tr><td>GH_IO.dll</td><td><em>&lt;Program Files&gt;\Rhinoceros 4.0\Plug-ins\Grasshopper\</em></td></tr><tr><td>Grasshopper.dll</td><td><em>&lt;Program Files&gt;\Rhinoceros 4.0\Plug-ins\Grasshopper\</em></td></tr><tr><td>RhinoCommon.dll</td><td><em>&lt;Program Files&gt;\Rhinoceros 4.0\Plug-ins\Grasshopper\rh_common\</em></td></tr></table></div><p><div class="mediaNear"><img src="../media/Separator_20Pixels_FullAlpha.png" /></div></p></li><li><p>By default, a Visual Studio project has two build 'flavours'; DEBUG and RELEASE. Debug builds are not
	        optimized by the compiler so the instructions that eventually get executed are very similar to the source code. 
	        Release builds do get optimized, which usually results in a slightly better performance (and occasionally vastly 
	        superior performance), but it can be very confusing to try and debug a Release version.</p><p>Debug and Release builds are written into different folders (usually 
	        <em>..\Bin\Debug\</em> and <em>..\Bin\Release\</em> ), which is a very useful
	        feature when writing stand-alone application, but it is outright confusing when your application is
	        loaded by another program. We advice that you alter the build folders so that both Debug and Release
	        builds are stored in the same location. This way there can be no confusion about which build you are loading. 
	        If you have VB Express, then you will not be able to adjust the build locations through the Visual Studio 
	        interface.
	        
	        <a href="71bed5cf-25c6-4d89-b50a-cff22efbda62.htm#ManualConfigurationMerge">See this topic on how to solve this with Visual Studio Express.</a></p><p>In <em>Project Properties</em>, go to the <em>Build</em> tab, 
	        switch the Configuration filter to <em>All Configurations</em> and set the 
	        <em>Output path:</em> to <em>bin\</em>:</p><p><div class="mediaCenter"><img src="../media/CS_Pro_BuildOutput.png" /></div></p><p><div class="mediaNear"><img src="../media/Separator_20Pixels_FullAlpha.png" /></div></p></li><li><p>When you override the default build folder destinations, both DEBUG and RELEASE flavours will end
            up in the same location. However, the file type of the compiled Class Library is still 
            <em>dll</em>. Even though this is the correct file type for a Grasshopper Component Library, 
            you must change the extension before Grasshopper will consider loading the library. You can automatically 
            rename the compiled dll using a Post-Build Event. Once again, if you have <em>C# Express</em> 
            you will not be able to add an event via the Visual Studio UI. 
            
            <a href="71bed5cf-25c6-4d89-b50a-cff22efbda62.htm#ManualPostBuildEvents">See this topic on how to solve this with Visual Studio Express.</a></p><p><div class="mediaNear"><img src="../media/Separator_20Pixels_FullAlpha.png" /></div></p><p>On the <em>Build Events</em> tab of the Project Properties you will find a text field
            called <em>Post-build event command line</em> where you can enter the following macro:</p><p><div class="mediaNear"><img src="../media/Separator_20Pixels_FullAlpha.png" /></div></p><p><span class="code">Copy "$(TargetPath)" "$(TargetDir)\$(ProjectName).gha"</span></p><p><span class="code">Erase "$(TargetPath)"</span></p><p><div class="mediaNear"><img src="../media/Separator_20Pixels_FullAlpha.png" /></div></p><p><div class="mediaCenter"><img src="../media/CS_Pro_PostBuildEvents.png" /></div></p><p><div class="mediaNear"><img src="../media/Separator_20Pixels_FullAlpha.png" /></div></p></li><li><p>You are now finished with the project setup for Grasshopper Component Libraries. When you compile
            your new project, the contents of the build folder should be:</p><p><div class="mediaCenter"><img src="../media/VB_Pro_BuildFolderContent.png" /></div></p><p><div class="mediaNear"><img src="../media/Separator_20Pixels_FullAlpha.png" /></div></p></li></ol></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID0RBSection" class="collapsibleSection"><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><span class="nolink">Loading and debugging custom Component Libraries.</span></div></div></div></div><div id="pageFooter" class="pageFooter">Grasshopper for Rhino 7.13.21348.13000 (Last updated: 12/15/2021)<br />Copyright © 2009-2021 Robert McNeel &amp; Associates<p><a href="https://discourse.mcneel.com/c/grasshopper" target="_blank">Report wishes and bugs at discourse.mcneel.com</a></p></div></body></html>