<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Project Setup (VS.Express)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="71bed5cf-25c6-4d89-b50a-cff22efbda62" /><meta name="Description" content="Please note that we now have Assembly Wizards for Grasshopper and it is no longer necessary to manually create a GHA project in Visual Studio." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Grasshopper API<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/723c01da-9986-4db2-8f53-6f3a7494df75.htm" title="Grasshopper API" tocid="roottoc">Grasshopper API</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/8b9acc0a-5165-4427-aea5-1873faffb4ff.htm" title="Development" tocid="8b9acc0a-5165-4427-aea5-1873faffb4ff">Development</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/d5ac95cc-3592-49a7-9162-d1bd981fb6c5.htm" title="GHA Assembly Wizards" tocid="d5ac95cc-3592-49a7-9162-d1bd981fb6c5">GHA Assembly Wizards</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/bc188193-19ff-4ae5-a3ed-2e78c34a306e.htm" title="Assembly Hierarchy" tocid="bc188193-19ff-4ae5-a3ed-2e78c34a306e">Assembly Hierarchy</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/99f64b89-5975-4ebe-adc6-24da038e915f.htm" title="Project Setup (VB.NET)" tocid="99f64b89-5975-4ebe-adc6-24da038e915f">Project Setup (VB.NET)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/f00ac74b-492c-44fe-8da3-b28265dc820f.htm" title="Project Setup (C#)" tocid="f00ac74b-492c-44fe-8da3-b28265dc820f">Project Setup (C#)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/71bed5cf-25c6-4d89-b50a-cff22efbda62.htm" title="Project Setup (VS.Express)" tocid="71bed5cf-25c6-4d89-b50a-cff22efbda62">Project Setup (VS.Express)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Project Setup (VS.Express)</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p><strong>Please note that we now have
      <a href="d5ac95cc-3592-49a7-9162-d1bd981fb6c5.htm">Assembly Wizards for Grasshopper</a>
      and it is no longer necessary to manually
      create a GHA project in Visual Studio.</strong></p><p>If you are using the Express version of Visual Studio, then you might not be able to
      apply all required settings through the VS User Interface. In this case you'll have to modify the
      project files manually to apply the settings.</p><p><strong>If you are using Visual Studio Professional, you can safely ignore this page.</strong></p><p>
        This document outlines how to manually modify <em>csproj</em> and 
        <em>vbproj</em> files.
        <ul><li><a href="#ManualConfigurationMerge">Override Configuration Folders</a></li><li><a href="#ManualPostBuildEvents">Add Post-Build Events</a></li><li><a href="#ManualDebugStartAction">Set Debug Start Action</a></li></ul></p></div><div class="collapsibleAreaRegion" id="ManualConfigurationMerge"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Override Configuration Folders</span></div><div id="ID1RBSection" class="collapsibleSection"><p>It is useful to override the Visual Studio default behaviour regarding build configuration
        output. By default, DEBUG and RELEASE configurations (or 'flavours') are outputted to unique
        folders. This can cause confusion during debugging.</p><p>In order to override the output folders, open the project file in a text editor. 
        If you're using VB then the project file will have the <em>*.vbproj</em> extension.
        If you're using C# then the project file will have the <em>*.csproj</em> extension.
        Ideally you should use a text editor that understands xml-formatting, but Notepad will do.</p><p>Inside the project file, locate the property group that has to do with the Debug and Release
        configurations. They will probably be called:
        
        <div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAEAACAAA_tab1" class="codeSnippetContainerTabSingle">XML</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAEAACAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAEAACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAEAACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">PropertyGroup</span> <span class="highlight-xml-attribute-name">Condition</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' "</span><span class="highlight-xml-bracket">&gt;</span>
<span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">PropertyGroup</span> <span class="highlight-xml-attribute-name">Condition</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' "</span><span class="highlight-xml-bracket">&gt;</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAEAACAAA");</script>
        
        Inside these property groups you will find OutputPath nodes:
        
        <div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACAACAAA_tab1" class="codeSnippetContainerTabSingle">XML</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACAACAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACAACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACAACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">OutputPath</span><span class="highlight-xml-bracket">&gt;</span>bin\Debug\<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">OutputPath</span><span class="highlight-xml-bracket">&gt;</span>
<span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">OutputPath</span><span class="highlight-xml-bracket">&gt;</span>bin\Release\<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">OutputPath</span><span class="highlight-xml-bracket">&gt;</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACAACAAA");</script>
        
		You'll have to change these to point to the same folder. We recommend:
		
		<div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAAACAAA_tab1" class="codeSnippetContainerTabSingle">XML</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAAACAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAAACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAAACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">OutputPath</span><span class="highlight-xml-bracket">&gt;</span>bin\<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">OutputPath</span><span class="highlight-xml-bracket">&gt;</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAAACAAA");</script></p></div><div class="collapsibleAreaRegion" id="ManualPostBuildEvents"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Add Post-Build Events</span></div><div id="ID2RBSection" class="collapsibleSection"><p>It is vital to add a Post-Build event to a Grasshopper Component Library since
        Grasshopper will only consider <em>*.gha</em> files during plug-in loading.
        Since your project is a <em>Class Library</em>, it will automatically
        be compiled into a <em>*.dll</em> file.</p><p>In order to override the output folders, open the project file in a text editor. 
        If you're using VB then the project file will have the <em>*.vbproj</em> extension.
        If you're using C# then the project file will have the <em>*.csproj</em> extension.
        Ideally you should use a text editor that understands xml-formatting, but Notepad will do.</p><p>By default, a project file (vbproj for VB.NET; csproj for C#) does not contain any
        Build Events, so you'll have to add the entire section in the project file Xml data.
        Navigate towards the bottom of the project file. Just before the closing &lt;/Project&gt;
        tag, insert the following PropertyGroup:
        
        <div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAAABAAA_tab1" class="codeSnippetContainerTabSingle">XML</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAAABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAAABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAAABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">PropertyGroup</span><span class="highlight-xml-bracket">&gt;</span>
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">PostBuildEvent</span><span class="highlight-xml-bracket">&gt;</span>Copy "$(TargetPath)" "$(TargetDir)\$(ProjectName).gha"
                  Erase "$(TargetPath)"
  <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">PostBuildEvent</span><span class="highlight-xml-bracket">&gt;</span>
<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">PropertyGroup</span><span class="highlight-xml-bracket">&gt;</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAAABAAA");</script></p></div><div class="collapsibleAreaRegion" id="ManualDebugStartAction"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Set Debug Start Action</span></div><div id="ID3RBSection" class="collapsibleSection"><p>It is not possible to directly debug a Grasshopper Component Library, since it must
        be loaded by Grasshopper, which in turn must be loaded by Rhinoceros. So, in order to debug
        a <em>*.gha</em> file you must first start Rhino. This is called a 
        <em>Debug Start Action</em> and VS Express does not allow you to set one
        via its own UI.</p><p>TODO, Finish this topic...</p></div></div></div><div id="pageFooter" class="pageFooter">Grasshopper for Rhino 7.4.21067.13000 (Last updated: 3/11/2021)<br />Copyright © 2009-2021 Robert McNeel &amp; Associates<p><a href="https://discourse.mcneel.com/c/grasshopper" target="_blank">Report wishes and bugs at discourse.mcneel.com</a></p></div></body></html>